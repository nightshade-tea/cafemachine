
              Analyzing cafemachine memory dumps with volatility
              ==================================================

The cafe device can generate raw memory dumps on demand, containing all data on
the physical address space from address 0 up to the highest address mapped to
RAM.

A memory dump can be triggered by the ioctl operation CAFE_IOCTL_DUMP_MEM.
This command causes the cafe driver to tell the cafe device to read all content
from RAM and write it in a file on the host machine.

1. Setting up volatility
~~~~~~~~~~~~~~~~~~~~~~~~

First of all, grab the source code for volatility3:

    https://github.com/volatilityfoundation/volatility3

In order to use memory analysis plugins on volatility, you'll need the symbol
table for the linux kernel image that is running on the guest VM.

For example, if you are running debian on the guest these are the steps:

- Install the debug kernel package

    apt-get install linux-image-$(uname -r)-dbg

- Copy the debug kernel image from /usr/lib/debug/boot/vmlinux-$(uname -r) to
  the host

- Extract debug symbols using dwarf2json

    dwarf2json linux --elf vmlinux > symbols.json

    available at https://github.com/volatilityfoundation/dwarf2json

- Copy the generated json to volatility3/volatility3/symbols/linux/

Now you can use volatility to analyze the memory dumps generated by the cafe
device with

    vol -f <dumpfile> <plugin>

If you'd like to run plugins in batch you can use the bash script analyze.sh
which takes as an argument a text file with each plugin you want to run in a
line.
